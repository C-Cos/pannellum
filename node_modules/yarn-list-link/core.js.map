{"version":3,"file":"core.js","sourceRoot":"","sources":["core.ts"],"names":[],"mappings":";AAAA;;GAEG;;;;AAEH,uCAAoD;AACpD,mCAAyC;AACzC,kFAA+D;AAE/D,SAAgB,oBAAoB,CAAC,GAAW;IAE/C,OAAO,IAAA,aAAI,EAAC,GAAG,EAAE,cAAc,EAAE,iBAAiB,CAAC,CAAA;AACpD,CAAC;AAHD,oDAGC;AAED,SAAgB,gBAAgB,CAAC,GAAW;IAE3C,MAAM,IAAI,GAAG,oBAAoB,CAAC,GAAG,CAAC,CAAC;IAEvC,IAAI,IAAA,qBAAU,EAAC,IAAI,CAAC,EACpB;QACC,IAAI,IAAI,GAAG,IAAA,uBAAY,EAAC,IAAI,CAAC,CAAC;QAC9B,IAAI,EAAE,aAAa,GAAG,EAAc,EAAE,GAAG,IAAI,CAAA;QAE7C,OAAO,aAAa;aAClB,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,IAAA,kBAAS,EAAC,CAAC,CAAC,CAAC,CACvB;KACD;AACF,CAAC;AAbD,4CAaC;AAED,SAAgB,YAAY,CAAC,GAAW;IAEvC,IAAI,IAAI,GAAG,IAAA,cAAiB,EAAC,GAAG,CAAC,CAAC;IAElC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAA,qBAAU,EAAC,IAAI,CAAC,EAC9B;QACC,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC;KACpD;IAED,OAAO,gBAAgB,CAAC,IAAI,CAAC,CAAA;AAC9B,CAAC;AAVD,oCAUC;AAED,YAAY,CAAC,YAAY,GAAG,YAAY,CAAC;AACzC,YAAY,CAAC,OAAO,GAAG,YAAY,CAAC;AAEpC,kBAAe,YAAY,CAAC","sourcesContent":["/**\n * Created by user on 2020/6/5.\n */\n\nimport { existsSync, readJSONSync } from 'fs-extra';\nimport { join, normalize } from \"upath2\";\nimport findWorkspaceRoot from 'find-yarn-workspace-root2/core';\n\nexport function getYarnIntegrityPath(cwd: string)\n{\n\treturn join(cwd, 'node_modules', '.yarn-integrity')\n}\n\nexport function yarnListLinkCore(cwd: string): string[]\n{\n\tconst file = getYarnIntegrityPath(cwd);\n\n\tif (existsSync(file))\n\t{\n\t\tlet json = readJSONSync(file);\n\t\tlet { linkedModules = [] as string[] } = json\n\n\t\treturn linkedModules\n\t\t\t.map(v => normalize(v))\n\t\t;\n\t}\n}\n\nexport function yarnListLink(cwd: string): string[]\n{\n\tlet root = findWorkspaceRoot(cwd);\n\n\tif (!root || !existsSync(root))\n\t{\n\t\tthrow new Error(`can't found current package root`);\n\t}\n\n\treturn yarnListLinkCore(root)\n}\n\nyarnListLink.yarnListLink = yarnListLink;\nyarnListLink.default = yarnListLink;\n\nexport default yarnListLink;\n"]}